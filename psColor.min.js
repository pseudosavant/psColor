(function(n){"use strict";var t=n.ps=n.ps||{};t.color={};t.color.getImageAverageColor=function(n,t){var f,v,c;if(!n)return!1;t=t||{};var s={tooDark:(t.tooDark||.03)*765,tooLight:(t.tooLight||.97)*765,tooAlpha:(t.tooAlpha||.1)*255},h=n.width,r=n.height,l=document.createElement("canvas").getContext("2d");l.drawImage(n,0,0,h,r);var o=l.getImageData(0,0,h,r).data,u={r:0,g:0,b:0,a:0},e=0,i={r:0,g:0,b:0,a:0},a=0;for(f=0,v=h*r*4;f<v;f+=4)i.r=o[f],i.g=o[f+1],i.b=o[f+2],i.a=o[f+4],i.a>s.tooAlpha&&(a=i.r+i.g+i.b)>s.tooDark&&a<s.tooLight&&(u.r+=i.r,u.g+=i.g,u.b+=i.b,u.a+=i.a,e++);return c={r:null,g:null,b:null,a:null},e>0&&(c={r:Math.round(u.r/e),g:Math.round(u.g/e),b:Math.round(u.b/e),a:Math.round(u.a/e)}),{channels:c,toStringRgb:function(){var n=this.channels;return[n.r,n.g,n.b].join(", ")},toStringRgba:function(){var n=this.channels;return[n.r,n.g,n.b,n.a].join(", ")},toStringHex:function(){var n=function(n){return r=Math.round(n).toString(16),r.length<2&&(r="0"+r),r},t=this.channels;return[n(t.r),n(t.g),n(t.b)].join("")}}}})(this);